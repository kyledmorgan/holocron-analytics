# PR #38: Add TYPE KEY controlled vocabulary to page classification prompts

## Header

| Field | Value |
|---|---|
| **PR Number** | 38 |
| **Title** | Add TYPE KEY controlled vocabulary to page classification prompts |
| **URL** | https://github.com/kyledmorgan/holocron-analytics/pull/38 |
| **State** | merged |
| **Created** | 2026-02-07T05:35:56Z |
| **Updated** | 2026-02-07T05:48:34Z |
| **Merged** | 2026-02-07T05:48:34Z |
| **Base branch** | `working_20260115` |
| **Head branch** | `copilot/add-type-key-descriptions` |
| **Merge commit SHA** | `dd102578f96e4bcc765d51911037ec58bf9e68af` |

---

## PR Body

Reduces misclassification (e.g., Character incorrectly returned as WorkMedia) by embedding explicit type definitions into classification prompts. The model now treats the enum list as a controlled vocabulary with clear boundaries.

### Changes

**Prompt Enhancements**
- Added TYPE KEY block with explicit definitions for all 12 primary types including strong cues and anti-patterns
- Added 5 DECISION RULES to disambiguate common confusion cases
- Added SECONDARY TYPES and TAG GUIDANCE sections

**Schema Alignment**
- Consolidated `Technology`, `Vehicle`, `Weapon` â†’ `ObjectArtifact`
- Renamed `Unknown` â†’ `Other`
- Updated `page_classification.py` version to 1.1.0
- Updated `dry_run_page_classification.py` prompt_version to `dry_run_v3`

### Example: TYPE KEY Block

```
PersonCharacter:
- A sentient individual in-universe: people, Force users, named droids as individuals
- Strong cues: biography, "was aâ€¦ whoâ€¦", personal history, relationships
- NOT this: a film/book/comic itself (WorkMedia), a battle (EventConflict)

ObjectArtifact:
- A tangible item: weapon, ship, vehicle model, device, droid model line
- Named one-off ship ("Millennium Falcon") => ObjectArtifact
- Named droid as a person ("R2-D2") => PersonCharacter
```

### Decision Rules (excerpt)
1. Page centered on named individual's life/story â†’ `PersonCharacter` even if it references many films/books
2. Title is a film/book/comic/game â†’ `WorkMedia` even if it contains character lists
5. Named droid-as-person â†’ `PersonCharacter`; droid model line â†’ `ObjectArtifact`

<!-- START COPILOT CODING AGENT SUFFIX -->



<!-- START COPILOT ORIGINAL PROMPT -->



<details>

<summary>Original prompt</summary>

> > ## Additive: â€œType Keyâ€ Descriptions to Improve Classification Accuracy
> >
> > Goal: reduce misclassification (e.g., Character incorrectly returned as WorkMedia) by embedding **short, explicit type definitions** inside the prompt so the model treats the enum list as a controlled vocabulary with clear boundaries.
> >
> > ### Where this goes
> > Add this **Type Key** block into the *user* message (or as a dedicated system+user segment) right before the INPUT excerpt. Keep it stable across runs.
> >
> > ---
> > ## TYPE KEY (Controlled Vocabulary)
> > Choose exactly **one** `primary_type`. Use `secondary_types` only to add nuance (subtypes) that still fit the primary selection.
> >
> > ### PersonCharacter
> > - A sentient individual (or named character persona) in-universe: people, Force users, named aliens, named droids as individuals, named creatures if treated as a character.
> > - Strong cues: biography, â€œwas aâ€¦ whoâ€¦â€, personal history, relationships, homeworld, affiliations, appearances.
> > - NOT this: a film/book/comic itself (WorkMedia), a battle (EventConflict), a planet (LocationPlace).
> >
> > ### LocationPlace
> > - A physical place: planet, moon, city, region, facility, shipyard, temple, base, station, terrain feature.
> > - Strong cues: geography, climate, coordinates, â€œlocated on/inâ€, inhabitants, points of interest.
> >
> > ### WorkMedia
> > - A published work: film, episode, series, novel, comic issue/run, game, soundtrack, reference book.
> > - Strong cues: release date, creators, publisher, â€œis a film/novel/comicâ€, plot summary as the primary framing.
> > - NOT this: a character who appears in a film (that stays PersonCharacter).
> >
> > ### EventConflict
> > - A discrete event: battle, war, raid, uprising, treaty signing, catastrophe, mission, duel, major incident.
> > - Strong cues: â€œbattle ofâ€¦â€, â€œduringâ€¦â€, timeline emphasis, participants, outcome, casualties.
> >
> > ### Organization
> > - A group or formal body: governments, militaries, orders, syndicates, corporations, councils, clans.
> > - Strong cues: membership, leadership, doctrine, structure, formation/dissolution.
> >
> > ### Species
> > - A biological species or sentient group (not a single individual): Human, Twiâ€™lek, Wookiee, etc.
> > - Strong cues: physiology, culture, homeworlds (plural), notable members list.
> >
> > ### ObjectArtifact
> > - A tangible item: weapon, ship (specific named vessel), vehicle model, device, relic, armor, droid *model line*.
> > - Distinguish:
> >   - **Named one-off ship** (â€œMillennium Falconâ€) => ObjectArtifact
> >   - **Class/model** (â€œT-65B X-wingâ€) => ObjectArtifact
> >   - **Named droid as a person** (â€œR2-D2â€) => PersonCharacter
> >   - **Droid model** (â€œR2-series astromech droidâ€) => ObjectArtifact
> >
> > ### Concept
> > - An abstract idea or system: the Force, hyperspace, ideologies, technologies as concepts, doctrines.
> > - Strong cues: definitions, principles, mechanics, applications, not a single place/person/event.
> >
> > ### TimePeriod
> > - A span of time: eras, ages, reigns, periods (e.g., â€œImperial Eraâ€, â€œHigh Republic Eraâ€).
> > - Strong cues: start/end markers, â€œeraâ€, â€œperiodâ€, chronology framing.
> >
> > ### MetaReference
> > - Cross-page helper concepts: disambiguation, lists, timelines, glossaries, behind-the-scenes reference aggregations.
> > - Strong cues: list-of entries, index pages, â€œmay refer toâ€, navigation role.
> >
> > ### TechnicalSitePage
> > - Site policy/technical/wiki infrastructure pages: protection policy, templates, categories, guidelines, help pages.
> > - Strong cues: wiki policy language, editors, formatting instructions, non-universe content.
> >
> > ### Other
> > - Only use when none of the above apply and explain why in `rationale_short`.
> >
> > ---
> > ## Decision Rules (to reduce common errors)
> > 1) If the page is centered on a **named individualâ€™s life/story**, it is **PersonCharacter** even if it references many films/books.
> > 2) If the title is a **film/book/comic/game**, it is **WorkMedia** even if it contains character lists.
> > 3) If the page is a **battle/war/incident**, it is **EventConflict**.
> > 4) If the page is an **era** or â€œAge ofâ€¦â€, it is **TimePeriod**.
> > 5) Named droid-as-person => **PersonCharacter**; droid model line => **ObjectArtifact**.
> >
> > ---
> > ## Secondary Types (optional, free-text)
> > Use `secondary_types` to add specificity like:
> > - â€œJediâ€, â€œSithâ€, â€œSmugglerâ€, â€œPlanetâ€, â€œSpace stationâ€, â€œComic seriesâ€, â€œFilm episodeâ€, â€œBattleâ€, â€œReligious orderâ€
> > Each `secondary_types[i].type` is free-text; `weight` is 0.0â€“1.0.
> >
> > ---
> > ## Tag Guidance (optional)
> > Suggested tags should be meaningful and not redundant with `primary_type`.
> > - Use `tag_type` examples: "Faction", "Role", "Species", "Era", "Theme", "EntitySubtype"
> > - Use `visibility`: "public" for user-facing, "hidden" for internal retrieval helpers.


</details>



<!-- START COPILOT CODING AGENT TIPS -->
---

ðŸ’¬ We'd love your input! Share your thoughts on Copilot coding agent in our [2 minute survey](https://gh.io/copilot-coding-agent-survey).

---

## Comments

_No comments._

---

## Review Comments (inline diff)

_No inline review comments._

---

## Copilot Artifacts

_No Copilot artifact indicators detected._
