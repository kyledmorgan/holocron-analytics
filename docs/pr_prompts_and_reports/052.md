# PR #52: Phase 3: Generic entity extraction, backfill CLI, queue health monitoring

## Header

| Field | Value |
|---|---|
| **PR Number** | 52 |
| **Title** | Phase 3: Generic entity extraction, backfill CLI, queue health monitoring |
| **URL** | https://github.com/kyledmorgan/holocron-analytics/pull/52 |
| **State** | merged |
| **Created** | 2026-02-13T05:06:24Z |
| **Updated** | 2026-02-13T05:26:39Z |
| **Merged** | 2026-02-13T05:26:39Z |
| **Base branch** | `working_20260115` |
| **Head branch** | `copilot/expand-phase-3-coverage` |
| **Merge commit SHA** | `1826d73723670e69162ea8a1e4115d99dc806983` |

---

## PR Body

Implements Phase 3 of the LLM-derived data roadmap: broader entity coverage, automated backfill tooling, and queue operations.

### Generic Entity Extraction (3.1)
- `entity_extraction_generic_v1` interrogation handling all entity types (PersonCharacter, LocationPlace, Organization, VehicleCraft, Droid, etc.)
- Open-ended type taxonomy, confidence scoring guidance, flexible attributes
- Contract: `src/llm/contracts/entity_extraction_generic_v1_schema.json`
- Handler: `src/llm/handlers/entity_extraction_generic.py`

### Backfill CLI (3.2)
- `src/llm/cli/backfill.py` with subcommands: `entities`, `relationships`, `classification`
- Safety rails: max_jobs, max_queue_depth, rate limiting, priority bands

```bash
python -m src.llm.cli.backfill entities \
  --entity-type=PersonCharacter \
  --confidence-threshold=0.7 \
  --max-jobs=100
```

### Queue Health Monitoring (3.3)
- Migration `0029_queue_health_views.sql` adds:
  - `llm.vw_queue_health` â€” summary by status
  - `llm.vw_queue_health_by_type` â€” summary by job type
  - `llm.vw_queue_aged_jobs` â€” stale job detection
  - `llm.vw_queue_summary_by_priority` â€” priority band distribution

### Priority Escalation (3.4)
- `src/llm/cli/priority.py` with `escalate`, `bump`, `health` commands
- `llm.usp_escalate_aged_jobs` stored proc for anti-starvation

### Docs
- Removed Effort column from Phase 3 tables per roadmap hygiene requirements

### Tests
- 29 new unit tests for generic extraction validation
- All 424 LLM tests pass

<!-- START COPILOT CODING AGENT TIPS -->
---

ðŸ’¡ You can make Copilot smarter by setting up custom instructions, customizing its development environment and configuring Model Context Protocol (MCP) servers. Learn more [Copilot coding agent tips](https://gh.io/copilot-coding-agent-tips) in the docs.

---

## Comments

_No comments._

---

## Review Comments (inline diff)

_No inline review comments._

---

## Copilot Artifacts

_No Copilot artifact indicators detected._
