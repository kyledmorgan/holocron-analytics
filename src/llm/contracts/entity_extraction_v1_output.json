{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://holocron-analytics.local/schemas/llm/entity-extraction/v1",
  "title": "Entity Extraction V1 Output",
  "description": "Output schema for entity extraction jobs. Extracts entities (and optionally relationships) from source text. Phase 1 focuses on Droid entities.",
  "version": "1.0.0",
  "type": "object",
  "required": ["entities"],
  "properties": {
    "entities": {
      "type": "array",
      "description": "Array of extracted entities from the source text",
      "items": {
        "type": "object",
        "required": ["name", "type", "confidence"],
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 500,
            "description": "The canonical name of the entity as it appears in the text"
          },
          "type": {
            "type": "string",
            "description": "The entity type (e.g., 'Droid', 'PersonCharacter', 'LocationPlace'). Open-ended string; Phase 1 expects 'Droid' as primary target."
          },
          "confidence": {
            "type": "number",
            "minimum": 0.0,
            "maximum": 1.0,
            "description": "Confidence score: 1.0 = explicitly named, 0.7-0.9 = strongly implied, 0.4-0.6 = weakly implied, <0.4 = uncertain"
          },
          "aliases": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Alternative names or designations for this entity"
          },
          "attributes": {
            "type": "object",
            "additionalProperties": true,
            "description": "Flexible key-value attributes extracted from text. Common droid attributes: model, manufacturer, droid_class, affiliation, color, height"
          },
          "evidence_quote": {
            "type": ["string", "null"],
            "description": "Direct quote from source text supporting this entity extraction (for provenance)"
          }
        },
        "additionalProperties": false
      }
    },
    "relationships": {
      "type": "array",
      "description": "Optional array of relationships between entities. Phase 1 validates but does not persist relationships.",
      "items": {
        "type": "object",
        "required": ["from_entity", "to_entity", "relation_type", "confidence"],
        "properties": {
          "from_entity": {
            "type": "string",
            "description": "Name of the source entity in the relationship"
          },
          "to_entity": {
            "type": "string",
            "description": "Name of the target entity in the relationship"
          },
          "relation_type": {
            "type": "string",
            "description": "Type of relationship (e.g., 'owned_by', 'served', 'manufactured_by', 'companion_of')"
          },
          "start_date": {
            "type": ["string", "null"],
            "description": "Start date/era of the relationship (if known)"
          },
          "end_date": {
            "type": ["string", "null"],
            "description": "End date/era of the relationship (if known)"
          },
          "confidence": {
            "type": "number",
            "minimum": 0.0,
            "maximum": 1.0,
            "description": "Confidence score for this relationship"
          }
        },
        "additionalProperties": false
      }
    },
    "extraction_metadata": {
      "type": "object",
      "description": "Metadata about the extraction process",
      "properties": {
        "source_page_title": {
          "type": ["string", "null"],
          "description": "Title of the source page/document"
        },
        "total_entities_found": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of entities extracted"
        },
        "primary_type_focus": {
          "type": ["string", "null"],
          "description": "The entity type this extraction focused on (e.g., 'Droid' for Phase 1)"
        },
        "extraction_notes": {
          "type": ["string", "null"],
          "description": "Notes about the extraction process, ambiguities, or assumptions"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
